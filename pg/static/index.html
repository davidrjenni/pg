<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#f5f5f5">
	<title>pg</title>
</head>
<body>
	<h1>pg</h1>
	<textarea id='grammar'>Expr -> Expr "+" Term | Expr "-" Term | Term . Term -> Term "*" Factor | Term "/" Factor | Factor . Factor -> "(" Expr ")" | "NUMBER" .</textarea>
	<br />
	<button id='fmt'>Format</button>
	<br />
	Input: <input />
	<button id='parse'>Parse</button>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js"></script>
	<script>
		$(document).ready(function() {
			function post(url, d, succ, err) {
				$.ajax({type: 'POST', url: url, data: d, success: succ, error: err});
			}
			function format(g) {
				$('#grammar').val(g);
				var cols = 50;
				g.split(/\r\n|\r|\n/).forEach(function(e) { cols = Math.max(cols, e.length); });
				$('#grammar').attr('rows', g.split(/\r\n|\r|\n/).length + 1);
				$('#grammar').attr('cols',  cols);
			}
			function error(msg) { alert(msg); }
			$('#fmt').click(function() {
				post('/api/pg/fmt', $('#grammar').val(),
					function(data) { format(data); },
					function(rsp) { error(rsp.responseText); });
			});
			$('#fmt').click();
		});
	</script>
</body>
</html>